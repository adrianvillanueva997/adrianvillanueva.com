---
title: Why I’m Building a Real IoT System
date: '2025-08-02'
tags: ['rust', 'esp32', 'system design',"selfhost","programming"]
draft: false
summary: Esp32, rust, observability, plants and some MLOps system design.
---
import Callout from '@/components/Callout.astro';
import TechStack from '@/components/TechStack.astro';

## 🌱 The Motivation

Hydroponics, growing plants without soil, opens the door to fully automated, self-sustaining agricultural systems. But most “smart garden” setups today are just toys.

I wanted more:

- Real-time observability
- Robust data pipelines
- Scalable backend
- OTA updates
- Embedded ML on the edge
- Automation

Enter the **ESP32** family.

### 🔍 The Discovery

I had previously worked with Raspberry Pi and Arduino before, but the ESP32 ecosystem felt different: cheaper, more powerful, and purpose-built for IoT. After testing several variants:

- `ESP32-S3`: with vector instructions and AI acceleration.
- `ESP32-CAM`:for image capture and edge CV.
- `ESP32 with OLED`: for simple UX/display at the edge.

<Callout type="note">
I saw the potential for a **clean, modular system**, that can be powered by Rust, traced with OTEL, monitored end-to-end and with the option to integrate some MLOPS / FirmwareOps.
</Callout>

### 🏆 The goal

The end goal is to build a full hydroponics system, but for now, we will start with something simpler.

- Exploring Rust for embedded devices.
- Integration of OTA server and full control of FirmwareOps.
- Platform monitoring.
- Integration with a data and analytics platform.
- Monetization.

## 🚧 What’s Next

Over the next few weeks I’ll be expanding this system:

<TechStack technologies={["Rust", "ESP32", "MQTT", "RabbitMQ", "PostgreSQL", "OpenTelemetry", "Grafana", "Prometheus", "MLflow", "Redis", "Axum"]} />

- Add OTA server in Axum + Redis.
- Full MLOps pipeline with edge inferencing.
- Monitor power, water, and nutrient sensors.
- Weather station.
- Automatic adjustments (fan, light, water pump).
- Real-world testing with real plants.

## 🧠 Zenthos Architecture (Core Sensor Flow)

```d2


IoT: {
  label: "IoT Device"
  style: {
    stroke: "#1890FF"
  }
  ESP32: "📟 ESP32 Temp Sensor"
}

Messaging: {
  label: "Messaging Layer"
  style: {
    stroke: "#FA8C16"
  }
  MQTT: "📡 MQTT Broker"
  RabbitMQ: "🐇 RabbitMQ Queue"
}

Processing: {
  label: "Processing Layer"
  style: {
    stroke: "#52C41A"
  }
  Middleware: "⚙️ Middleware (Enrichment + Validation + Data Ingestion)"
  Consumer: "🧠 Consumer (Analytics, Alerting, Workflows)"
}

Storage: {
  label: "Storage"
  style: {
    stroke: "#2F54EB"
  }
  TSDB: "🗄️ TimescaleDB"
}

Observability: {
  label: "Observability"
  style: {
    stroke: "#EB2F96"
  }
  OTEL: "🔍 OpenTelemetry Collector"
  Grafana: "📊 Grafana"
}

# Connections
IoT.ESP32 -> Messaging.MQTT
Messaging.MQTT -> Processing.Middleware
Processing.Middleware -> Messaging.RabbitMQ
Processing.Middleware -> Storage.TSDB
Processing.Middleware -> Observability.OTEL
Messaging.RabbitMQ -> Processing.Consumer
Processing.Consumer -> Observability.OTEL
Observability.OTEL -> Observability.Grafana
Storage.TSDB -> Observability.Grafana

```

## 🧱 Full System Overview

```d2


Devices: {
  label: "Devices"
  style: {fill: "#d1e9ff"; stroke: "#4a90e2"}
  ESP32: "📟 ESP32 Devices (S3, OLED, CAM)"
}

Ingestion: {
  label: "Ingestion Layer"
  style: { stroke: "#34a853"}
  MQTT: "📡 MQTT Broker"
  Middleware: "⚙️ Middleware Service (Redis + OTEL export)"
}

Bus: {
  label: "Message Bus"
  style: { stroke: "#f57c00"}
  RabbitMQ: "🐇 RabbitMQ"
}

Services: {
  label: "Services"
  style: {stroke: "#8e24aa"}
  OTA: "🔄 OTA Server (Axum) + Redis"
  ModelServer: "🧠 Model Server (MLflow REST API or custom)"
  Workers: "👷 Consumers / Workers"
}

Storage: {
  label: "Storage"
  style: { stroke: "#616161"}
  DB: "🗄️ TimescaleDB or PostgreSQL"
}

Observability: {
  label: "Observability"
  style: { stroke: "#fbc02d"}
  OTEL: "🔍 OTEL Collector"
  Prometheus: "📊 Prometheus"
  Tempo: "⏱️ Tempo"
  Loki: "📝 Loki"
  Grafana: "📈 Grafana"
}

Devices.ESP32 -> Ingestion.MQTT
Ingestion.MQTT -> Ingestion.Middleware
Ingestion.Middleware -> Bus.RabbitMQ
Ingestion.Middleware -> Observability.OTEL
Devices.ESP32 -> Services.OTA
Services.OTA -> Storage.DB
Services.ModelServer -> Services.OTA
Bus.RabbitMQ -> Services.Workers
Services.Workers -> Storage.DB
Services.Workers -> Observability.OTEL
Observability.OTEL -> Observability.Prometheus
Observability.OTEL -> Observability.Tempo
Observability.OTEL -> Observability.Loki
Observability.Prometheus -> Observability.Grafana
Observability.Tempo -> Observability.Grafana
Observability.Loki -> Observability.Grafana

```

## 🔚 Final Thought

Zenthos is my commitment to full-stack, edge intelligence.
If you're building in this space, let's talk! I want to hear your thoughts.

I will expand about the architecture in the next post.
