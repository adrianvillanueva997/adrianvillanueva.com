---
import { Image } from 'astro:assets';
import { getEntry, render } from 'astro:content';
import { Icon } from 'astro-icon/components';
import mePhoto from '@/assets/me/me.jpg';
import BaseHead from '@/components/BaseHead.astro';
import Footer from '@/components/Footer.astro';
import Header from '@/components/Header.astro';
import { SITE_TITLE } from '@/consts';

// Get the about.md content
const aboutEntry = await getEntry('pages', 'about');

if (!aboutEntry) {
	throw new Error('About page content not found');
}

const { Content } = await render(aboutEntry);
const { name, occupation, email, linkedin, github } = aboutEntry.data;

// Timeline of countries lived in
const timeline = [
	{
		country: 'Spain',
		flag: 'ðŸ‡ªðŸ‡¸',
		city: 'Madrid',
		period: '1997 - 2021',
		description:
			'Born and raised. Started my career in software engineering.',
		icon: 'mdi:home-heart',
	},
	{
		country: 'Netherlands',
		flag: 'ðŸ‡³ðŸ‡±',
		city: 'Amsterdam',
		period: '2021 - 2024',
		description: 'Dove deep into data engineering and cloud platforms.',
		icon: 'mdi:bike',
	},
	{
		country: 'Japan',
		flag: 'ðŸ‡¯ðŸ‡µ',
		city: 'Tokyo',
		period: '2024 - Present',
		description:
			'Building next-generation data platforms and learning Japanese culture.',
		icon: 'mdi:temple-buddhist',
	},
];
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead
			title={`About - ${SITE_TITLE}`}
			description="Personal story and philosophy of Adrian Villanueva Martinez - Senior Software Engineer bridging European engineering excellence with global innovation."
		/>
	</head>
	<body>
		<Header />

		<main class="about-main">
			<div class="about-container">
				<!-- Hero Section with Photo -->
				<section class="hero-section">
					<div class="hero-content">
						<div class="hero-text">
							<h1 class="page-title">ABOUT</h1>
							<p class="tagline">
								From Spain to Tokyo â€” building resilient systems
								and exceptional developer experiences.
							</p>
						</div>
						<div class="hero-image">
							<Image
								src={mePhoto}
								alt={name || 'Adrian Villanueva Martinez'}
								width={400}
								height={500}
								class="profile-photo"
							/>
						</div>
					</div>
				</section>

				<!-- Quick Links -->
				<section class="quick-links">
					{
						email && (
							<a href={`mailto:${email}`} class="link-btn">
								<Icon name="mdi:email-outline" class="icon" />
								<span>Email</span>
							</a>
						)
					}
					{
						linkedin && (
							<a
								href={linkedin}
								target="_blank"
								rel="noopener noreferrer"
								class="link-btn"
							>
								<Icon name="mdi:linkedin" class="icon" />
								<span>LinkedIn</span>
							</a>
						)
					}
					{
						github && (
							<a
								href={github}
								target="_blank"
								rel="noopener noreferrer"
								class="link-btn"
							>
								<Icon name="mdi:github" class="icon" />
								<span>GitHub</span>
							</a>
						)
					}
					<a href="/resume" class="link-btn">
						<Icon name="mdi:file-document-outline" class="icon" />
						<span>Resume</span>
					</a>
				</section>

				<!-- Markdown Content -->
				<article class="prose">
					<Content />
				</article>

				<!-- Timeline Section -->
				<section class="timeline-section">
					<h2 class="timeline-title">Journey</h2>
					<div class="timeline">
						{
							timeline.map((item, index) => {
								const isLast = index === timeline.length - 1;

								return (
									<div class="timeline-item">
										<div class="timeline-marker">
											<div class="timeline-dot" />
											{!isLast && (
												<div class="timeline-line" />
											)}
										</div>
										<div class="timeline-content">
											<div class="timeline-header">
												<div class="country-info">
													<span class="country-flag">
														{item.flag}
													</span>
													<h3 class="timeline-country">
														{item.country}
													</h3>
												</div>
												<span class="timeline-period">
													{item.period}
												</span>
											</div>
											<p class="timeline-city">
												<Icon
													name={item.icon}
													class="city-icon"
												/>
												{item.city}
											</p>
											<p class="timeline-description">
												{item.description}
											</p>
										</div>
									</div>
								);
							})
						}
					</div>
				</section>

				<!-- Call to Action -->
				<section class="cta-section">
					<div class="cta-content">
						<h2>Let's Build Something</h2>
						<p>
							Interested in collaborating or just want to chat
							about data platforms, Rust, or audio synthesis?
						</p>
						<div class="cta-buttons">
							<a href="/contact" class="btn-primary"
								>Get In Touch</a
							>
							<a href="/portfolio" class="btn-secondary"
								>View My Work</a
							>
						</div>
					</div>
				</section>
			</div>
		</main>

		<Footer />

		<style>
			/* Main Container */
			.about-main {
				min-height: 60vh;
			}

			.about-container {
				max-width: 900px;
				margin: 0 auto;
				padding: 3rem 2rem;
			}

			/* Hero Section */
			.hero-section {
				margin-bottom: 4rem;
			}

			.hero-content {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 4rem;
				align-items: center;
			}

			.hero-text {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
			}

			.page-title {
				font-size: clamp(3rem, 8vw, 5rem);
				font-weight: 900;
				color: var(--text-primary);
				margin: 0;
				line-height: 1;
				letter-spacing: -0.03em;
				font-family: 'Orbitron', monospace;
			}

			.tagline {
				font-size: 1.375rem;
				color: var(--text-secondary);
				line-height: 1.6;
				margin: 0;
			}

			.hero-image {
				display: flex;
				justify-content: center;
				align-items: center;
			}

			.profile-photo {
				border: 3px solid var(--accent-cyan);
				box-shadow: 0 0 20px var(--accent-cyan-glow);
				transition: all 0.3s ease;
			}

			.profile-photo:hover {
				transform: scale(1.02);
				box-shadow: 0 0 30px var(--accent-cyan-glow);
			}

			/* Quick Links */
			.quick-links {
				display: flex;
				gap: 1rem;
				flex-wrap: wrap;
				justify-content: center;
				margin-bottom: 4rem;
				padding: 2rem 0;
				border-top: 2px solid var(--bg-tertiary);
				border-bottom: 2px solid var(--bg-tertiary);
			}

			.link-btn {
				display: inline-flex;
				align-items: center;
				gap: 0.625rem;
				padding: 0.875rem 1.75rem;
				background: var(--bg-secondary);
				border: 2px solid var(--bg-tertiary);
				color: var(--accent-cyan);
				text-decoration: none;
				font-family: 'Courier New', monospace;
				font-size: 0.9375rem;
				font-weight: 500;
				transition: all 0.25s ease;
				letter-spacing: 0.03em;
				position: relative;
				overflow: hidden;
			}

			.link-btn::before {
				content: '';
				position: absolute;
				top: 0;
				left: -100%;
				width: 100%;
				height: 100%;
				background: linear-gradient(
					90deg,
					transparent,
					var(--accent-cyan-glow),
					transparent
				);
				transition: left 0.5s ease;
			}

			.link-btn:hover::before {
				left: 100%;
			}

			.link-btn:hover {
				background: var(--accent-cyan);
				color: var(--bg-primary);
				border-color: var(--accent-cyan);
				transform: translateY(-3px);
				box-shadow: 0 6px 16px var(--accent-cyan-glow);
			}

			.link-btn .icon {
				width: 1.375rem;
				height: 1.375rem;
				transition: transform 0.25s ease;
			}

			.link-btn:hover .icon {
				transform: scale(1.1) rotate(5deg);
			}

			/* Prose Content */
			.prose {
				line-height: 1.85;
				color: var(--text-secondary);
				font-size: 1.0625rem;
				margin-bottom: 4rem;
			}

			.prose > * + * {
				margin-top: 1.5rem;
			}

			.prose h1,
			.prose h2,
			.prose h3,
			.prose h4 {
				color: var(--text-primary);
				font-family: 'Orbitron', monospace;
				font-weight: 700;
				line-height: 1.3;
				margin-top: 3rem;
				margin-bottom: 1.25rem;
				letter-spacing: -0.02em;
			}

			.prose h1 {
				font-size: 2.5rem;
				border-bottom: 3px solid var(--accent-cyan);
				padding-bottom: 0.75rem;
			}

			.prose h2 {
				font-size: 2rem;
				color: var(--accent-cyan);
			}

			.prose h3 {
				font-size: 1.5rem;
			}

			.prose h4 {
				font-size: 1.25rem;
			}

			.prose p {
				margin: 1.5rem 0;
				line-height: 1.85;
			}

			.prose strong {
				color: var(--text-primary);
				font-weight: 700;
			}

			.prose ul,
			.prose ol {
				margin: 1.5rem 0;
				padding-left: 2rem;
			}

			.prose li {
				margin-bottom: 1rem;
				line-height: 1.8;
			}

			.prose li::marker {
				color: var(--accent-cyan);
				font-weight: 700;
			}

			.prose a {
				color: var(--accent-cyan);
				text-decoration: none;
				border-bottom: 1px solid var(--accent-cyan);
				transition: all 0.2s ease;
			}

			.prose a:hover {
				color: var(--text-primary);
				border-bottom-color: var(--text-primary);
			}

			.prose hr {
				border: none;
				border-top: 2px solid var(--bg-tertiary);
				margin: 3rem 0;
			}

			.prose code {
				background: var(--bg-secondary);
				color: var(--accent-cyan);
				padding: 0.25em 0.5em;
				border-radius: 4px;
				font-size: 0.9em;
				font-family: 'Courier New', monospace;
			}

			/* Timeline Section */
			.timeline-section {
				margin: 4rem 0;
				padding: 3rem 0;
				border-top: 2px solid var(--bg-tertiary);
			}

			.timeline-title {
				font-size: 2.5rem;
				font-weight: 800;
				color: var(--accent-cyan);
				margin-bottom: 3rem;
				text-align: center;
				font-family: 'Orbitron', monospace;
				letter-spacing: -0.02em;
				text-transform: uppercase;
			}

			.timeline {
				max-width: 700px;
				margin: 0 auto;
				position: relative;
			}

			.timeline-item {
				display: flex;
				gap: 2rem;
				margin-bottom: 2.5rem;
				position: relative;
			}

			.timeline-item:last-child {
				margin-bottom: 0;
			}

			.timeline-marker {
				position: relative;
				display: flex;
				flex-direction: column;
				align-items: center;
				flex-shrink: 0;
			}

			.timeline-dot {
				width: 16px;
				height: 16px;
				background: var(--accent-cyan);
				border-radius: 50%;
				border: 3px solid var(--bg-primary);
				box-shadow: 0 0 12px var(--accent-cyan-glow);
				position: relative;
				z-index: 2;
				transition: all 0.3s ease;
			}

			.timeline-item:hover .timeline-dot {
				transform: scale(1.3);
				box-shadow: 0 0 20px var(--accent-cyan-glow);
			}

			.timeline-line {
				width: 2px;
				flex-grow: 1;
				background: linear-gradient(
					to bottom,
					var(--accent-cyan) 0%,
					var(--bg-tertiary) 100%
				);
				margin-top: 4px;
			}

			.timeline-content {
				flex: 1;
				background: var(--bg-secondary);
				border: 2px solid var(--bg-tertiary);
				padding: 1.75rem;
				border-radius: 4px;
				transition: all 0.3s ease;
			}

			.timeline-item:hover .timeline-content {
				border-color: var(--accent-cyan);
				transform: translateX(8px);
				box-shadow: 0 4px 16px var(--accent-cyan-glow);
			}

			.timeline-header {
				display: flex;
				justify-content: space-between;
				align-items: flex-start;
				gap: 1rem;
				margin-bottom: 1rem;
				flex-wrap: wrap;
			}

			.country-info {
				display: flex;
				align-items: center;
				gap: 0.75rem;
			}

			.country-flag {
				font-size: 2rem;
				line-height: 1;
			}

			.timeline-country {
				font-size: 1.5rem;
				font-weight: 700;
				color: var(--text-primary);
				margin: 0;
				font-family: 'Orbitron', monospace;
				letter-spacing: -0.01em;
			}

			.timeline-period {
				font-size: 0.875rem;
				color: var(--accent-cyan);
				font-family: 'Courier New', monospace;
				font-weight: 600;
				letter-spacing: 0.05em;
				white-space: nowrap;
			}

			.timeline-city {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				font-size: 1.0625rem;
				color: var(--text-secondary);
				margin: 0 0 0.875rem 0;
				font-weight: 500;
			}

			.city-icon {
				width: 1.125rem;
				height: 1.125rem;
				color: var(--accent-cyan);
			}

			.timeline-description {
				font-size: 0.9375rem;
				color: var(--text-muted);
				margin: 0;
				line-height: 1.7;
				font-style: italic;
			}

			.timeline-location {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				font-size: 0.9375rem;
				color: var(--text-muted);
				margin: 0;
				font-family: 'Courier New', monospace;
			}

			.location-icon {
				width: 1rem;
				height: 1rem;
				color: var(--accent-cyan);
			}

			/* CTA Section */
			.cta-section {
				background: var(--bg-secondary);
				border: 2px solid var(--bg-tertiary);
				border-radius: 8px;
				padding: 3rem;
				text-align: center;
				margin-top: 4rem;
			}

			.cta-content h2 {
				font-size: 2rem;
				color: var(--accent-cyan);
				margin-bottom: 1rem;
				font-family: 'Orbitron', monospace;
			}

			.cta-content p {
				color: var(--text-secondary);
				font-size: 1.125rem;
				margin-bottom: 2rem;
				line-height: 1.6;
			}

			.cta-buttons {
				display: flex;
				gap: 1.5rem;
				justify-content: center;
				flex-wrap: wrap;
			}

			/* Responsive */
			@media (max-width: 768px) {
				.about-container {
					padding: 2rem 1.25rem;
				}

				.hero-content {
					grid-template-columns: 1fr;
					gap: 2.5rem;
				}

				.hero-image {
					order: -1;
				}

				.page-title {
					font-size: 2.5rem;
				}

				.tagline {
					font-size: 1.125rem;
				}

				.quick-links {
					gap: 0.75rem;
				}

				.link-btn {
					padding: 0.625rem 1.25rem;
					font-size: 0.875rem;
				}

				.prose {
					font-size: 1rem;
				}

				.prose h1 {
					font-size: 2rem;
				}

				.prose h2 {
					font-size: 1.5rem;
				}

				.timeline-title {
					font-size: 2rem;
					margin-bottom: 2rem;
				}

				.timeline-item {
					gap: 1rem;
				}

				.timeline-content {
					padding: 1.25rem;
				}

				.timeline-company {
					font-size: 1.125rem;
				}

				.timeline-header {
					flex-direction: column;
					gap: 0.5rem;
				}

				.timeline-item:hover .timeline-content {
					transform: translateX(4px);
				}

				.cta-section {
					padding: 2rem 1.5rem;
				}

				.cta-content h2 {
					font-size: 1.5rem;
				}

				.cta-buttons {
					flex-direction: column;
					gap: 1rem;
				}
			}

			@media (max-width: 480px) {
				.about-container {
					padding: 1.5rem 1rem;
				}

				.page-title {
					font-size: 2rem;
				}

				.timeline-title {
					font-size: 1.75rem;
				}

				.timeline-item {
					gap: 0.75rem;
				}

				.timeline-content {
					padding: 1rem;
				}
			}
		</style>
	</body>
</html>
